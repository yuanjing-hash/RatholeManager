# Rathole Manager

Rathole Manager æ˜¯ä¸€ä¸ªç”¨äºç®¡ç† `rathole` åå‘ä»£ç†å·¥å…·çš„ Web UIã€‚å®ƒå…è®¸ç”¨æˆ·é€šè¿‡å›¾å½¢åŒ–ç•Œé¢è½»æ¾åœ°æ·»åŠ æœåŠ¡å™¨ã€å®šä¹‰è½¬å‘è§„åˆ™ï¼Œå¹¶å°†é…ç½®ä¸€é”®éƒ¨ç½²åˆ°è¿œç¨‹æœåŠ¡å™¨ä¸Šã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **Web ç®¡ç†ç•Œé¢**: é€šè¿‡æµè§ˆå™¨å³å¯ç®¡ç†æ‰€æœ‰æœåŠ¡å™¨å’Œè§„åˆ™ã€‚
- **æœåŠ¡å™¨ç®¡ç†**: æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤å°†è¦è¿è¡Œ `rathole` çš„æœåŠ¡å™¨èŠ‚ç‚¹ã€‚
- **è§„åˆ™å®šä¹‰**: çµæ´»å®šä¹‰ TCP/UDP è½¬å‘è§„åˆ™ï¼Œå…³è”å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ã€‚
- **ä¸€é”®éƒ¨ç½²**: è‡ªåŠ¨å°† `rathole` æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„é…ç½®æ¨é€åˆ°æŒ‡å®šçš„è¿œç¨‹æœåŠ¡å™¨ã€‚
- **è‡ªåŠ¨å®‰è£…**: åœ¨éƒ¨ç½²æ—¶ä¼šè‡ªåŠ¨åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šä¸‹è½½å¹¶å®‰è£… `rathole` ç¨‹åºã€‚
- **æœåŠ¡ç®¡ç†**: è‡ªåŠ¨åˆ›å»ºå¹¶ç®¡ç†è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ `systemd` æœåŠ¡ï¼Œå®ç°å¼€æœºè‡ªå¯å’Œè¿›ç¨‹å®ˆæŠ¤ã€‚
- **çŠ¶æ€ç›‘æ§**: æŸ¥çœ‹è¿œç¨‹ `rathole` æœåŠ¡çš„è¿è¡ŒçŠ¶æ€å’Œæ—¥å¿—ã€‚
- **å®‰å…¨å­˜å‚¨**: ä½¿ç”¨åŠ å¯†æ–¹å¼å­˜å‚¨æœåŠ¡å™¨çš„ SSH å‡­æ®ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **åç«¯**: Python 3, FastAPI, SQLAlchemy, Paramiko
- **å‰ç«¯**: Vue.js, Vite, Pinia, Axios
- **æ•°æ®åº“**: SQLite

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å…ˆå†³æ¡ä»¶

- Python 3.11+
- Node.js 18+ å’Œ npm

### åç«¯è®¾ç½®

1.  **è¿›å…¥åç«¯ç›®å½•**
    ```bash
    cd backend
    ```

2.  **åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3.  **å®‰è£…ä¾èµ–**
    > **å»ºè®®**: é¡¹ç›®å½“å‰ç¼ºå°‘ `requirements.txt` æ–‡ä»¶ã€‚è¯·åœ¨è™šæ‹Ÿç¯å¢ƒä¸­è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆå®ƒï¼š
    > `pip freeze > requirements.txt`
    ```bash
    pip install fastapi uvicorn sqlalchemy "databases[sqlite]" paramiko cryptography jinja2 python-jose passlib bcrypt
    ```

4.  **åˆ›å»ºæ•°æ®åº“**
    (è¯¥é¡¹ç›®åŒ…å«ä¸€ä¸ª `create_db.py` è„šæœ¬æ¥åˆå§‹åŒ–æ•°æ®åº“)
    ```bash
    python create_db.py
    ```

5.  **è¿è¡Œåç«¯æœåŠ¡**
    ```bash
    uvicorn main:app --reload --host 0.0.0.0 --port 8000
    ```
    API å°†åœ¨ `http://localhost:8000` ä¸Šå¯ç”¨ã€‚

### å‰ç«¯è®¾ç½®

1.  **è¿›å…¥å‰ç«¯ç›®å½•**
    ```bash
    cd frontend
    ```

2.  **å®‰è£…ä¾èµ–**
    ```bash
    npm install
    ```

3.  **è¿è¡Œå¼€å‘æœåŠ¡å™¨**
    ```bash
    npm run dev
    ```
    Web ç•Œé¢å°†åœ¨ `http://localhost:5173` (æˆ–å¦ä¸€ä¸ªå¯ç”¨ç«¯å£) ä¸Šå¯ç”¨ã€‚

## âš™ï¸ é…ç½®

ä¸ºäº†å®‰å…¨ï¼Œ`backend/security.py` ä¸­ç”¨äºåŠ å¯†å¯†ç çš„ `SECRET_KEY` ä¸åº”ç¡¬ç¼–ç ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œå¼ºçƒˆå»ºè®®ä»ç¯å¢ƒå˜é‡ä¸­è¯»å–å®ƒã€‚

```python
# backend/security.py
import os

# ä»ç¯å¢ƒå˜é‡è·å–å¯†é’¥ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä½¿ç”¨é»˜è®¤å€¼ï¼ˆä»…ç”¨äºå¼€å‘ï¼‰
SECRET_KEY = os.environ.get('RATHOLE_MANAGER_SECRET_KEY', 'pzsZzVd-hizgDy_u-M9Ypm2y2x41gT8m5eL2t_G2gPY=').encode()
```

## ğŸ“ API æ¦‚è§ˆ

- `GET /api/servers`: è·å–æ‰€æœ‰æœåŠ¡å™¨åˆ—è¡¨
- `POST /api/servers`: æ·»åŠ ä¸€ä¸ªæ–°æœåŠ¡å™¨
- `GET /api/rules`: è·å–æ‰€æœ‰è½¬å‘è§„åˆ™
- `POST /api/rules`: æ·»åŠ ä¸€æ¡æ–°è§„åˆ™
- `POST /api/deploy`: è§¦å‘éƒ¨ç½²æµç¨‹ï¼Œå°†é…ç½®åº”ç”¨åˆ°æ‰€æœ‰æœåŠ¡å™¨
- `GET /api/servers/{id}/status`: è·å–æŒ‡å®šæœåŠ¡å™¨ä¸Š `rathole` æœåŠ¡çš„çŠ¶æ€
- `GET /api/servers/{id}/logs`: è·å–æŒ‡å®š `rathole` æœåŠ¡çš„æ—¥å¿—
- `POST /api/servers/{id}/uninstall`: å¸è½½æŒ‡å®šæœåŠ¡å™¨ä¸Šçš„ `rathole` æœåŠ¡
